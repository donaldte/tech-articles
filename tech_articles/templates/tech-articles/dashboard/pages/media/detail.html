{% extends 'tech-articles/dashboard/pages/_page_base.html' %}
{% load i18n static %}

{% block page_title %}{{ media_file.title }}{% endblock %}

{% block page_content %}
<div class="max-w-5xl mx-auto">
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- Media Preview -->
    <div class="bg-bg-secondary rounded-lg p-6">
      <h3 class="text-lg font-semibold text-text-primary mb-4">{% translate 'Preview' %}</h3>
      
      <div class="bg-bg-tertiary rounded-lg overflow-hidden mb-4">
        {% if media_file.is_image %}
          <img 
            src="{{ file_url }}" 
            alt="{{ media_file.alt_text|default:media_file.title }}"
            class="w-full h-auto"
          >
        {% elif media_file.is_video %}
          <video controls class="w-full">
            <source src="{{ file_url }}" type="{{ media_file.mime_type }}">
            {% translate 'Your browser does not support the video tag.' %}
          </video>
        {% elif media_file.is_document %}
          <div class="flex flex-col items-center justify-center p-12">
            <svg class="w-24 h-24 text-text-tertiary mb-4" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z" clip-rule="evenodd" />
            </svg>
            <p class="text-text-primary font-medium">{{ media_file.file_name }}</p>
          </div>
        {% endif %}
      </div>
      
      <!-- Download Button -->
      <a href="{{ file_url }}" download class="btn btn-primary w-full">
        <svg class="w-5 h-5 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
        </svg>
        {% translate 'Download Original' %}
      </a>
      
      {% if thumbnail_url %}
      <a href="{{ thumbnail_url }}" download class="btn btn-secondary w-full mt-2">
        {% translate 'Download Thumbnail' %}
      </a>
      {% endif %}
    </div>
    
    <!-- File Information & Edit -->
    <div class="bg-bg-secondary rounded-lg p-6">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-lg font-semibold text-text-primary">{% translate 'File Information' %}</h3>
        <a href="{% url 'dashboard:media:file_edit' media_file.pk %}" class="text-primary hover:text-primary-dark">
          {% translate 'Edit' %}
        </a>
      </div>
      
      <dl class="space-y-3">
        <div>
          <dt class="text-sm font-medium text-text-tertiary">{% translate 'Title' %}</dt>
          <dd class="text-text-primary">{{ media_file.title }}</dd>
        </div>
        
        {% if media_file.description %}
        <div>
          <dt class="text-sm font-medium text-text-tertiary">{% translate 'Description' %}</dt>
          <dd class="text-text-primary">{{ media_file.description }}</dd>
        </div>
        {% endif %}
        
        {% if media_file.alt_text %}
        <div>
          <dt class="text-sm font-medium text-text-tertiary">{% translate 'Alt Text' %}</dt>
          <dd class="text-text-primary">{{ media_file.alt_text }}</dd>
        </div>
        {% endif %}
        
        <div>
          <dt class="text-sm font-medium text-text-tertiary">{% translate 'File Name' %}</dt>
          <dd class="text-text-primary">{{ media_file.file_name }}</dd>
        </div>
        
        <div>
          <dt class="text-sm font-medium text-text-tertiary">{% translate 'File Type' %}</dt>
          <dd class="text-text-primary">{{ media_file.get_file_type_display }}</dd>
        </div>
        
        <div>
          <dt class="text-sm font-medium text-text-tertiary">{% translate 'MIME Type' %}</dt>
          <dd class="text-text-primary font-mono text-sm">{{ media_file.mime_type }}</dd>
        </div>
        
        <div>
          <dt class="text-sm font-medium text-text-tertiary">{% translate 'File Size' %}</dt>
          <dd class="text-text-primary">{{ media_file.file_size_mb }} MB</dd>
        </div>
        
        {% if media_file.width and media_file.height %}
        <div>
          <dt class="text-sm font-medium text-text-tertiary">{% translate 'Dimensions' %}</dt>
          <dd class="text-text-primary">{{ media_file.width }} Ã— {{ media_file.height }} px</dd>
        </div>
        {% endif %}
        
        {% if media_file.folder %}
        <div>
          <dt class="text-sm font-medium text-text-tertiary">{% translate 'Folder' %}</dt>
          <dd class="text-text-primary">{{ media_file.folder.name }}</dd>
        </div>
        {% endif %}
        
        {% if media_file.tags.exists %}
        <div>
          <dt class="text-sm font-medium text-text-tertiary">{% translate 'Tags' %}</dt>
          <dd class="flex flex-wrap gap-2">
            {% for tag in media_file.tags.all %}
            <span class="px-2 py-1 bg-primary/10 text-primary rounded text-sm">{{ tag.name }}</span>
            {% endfor %}
          </dd>
        </div>
        {% endif %}
        
        <div>
          <dt class="text-sm font-medium text-text-tertiary">{% translate 'Access Level' %}</dt>
          <dd class="text-text-primary">{{ media_file.get_access_level_display }}</dd>
        </div>
        
        <div>
          <dt class="text-sm font-medium text-text-tertiary">{% translate 'Uploaded By' %}</dt>
          <dd class="text-text-primary">{{ media_file.uploaded_by.email|default:"Unknown" }}</dd>
        </div>
        
        <div>
          <dt class="text-sm font-medium text-text-tertiary">{% translate 'Upload Date' %}</dt>
          <dd class="text-text-primary">{{ media_file.created_at|date:"F j, Y, g:i a" }}</dd>
        </div>
        
        <div>
          <dt class="text-sm font-medium text-text-tertiary">{% translate 'Downloads' %}</dt>
          <dd class="text-text-primary">{{ media_file.download_count }}</dd>
        </div>
      </dl>
      
      <!-- Actions -->
      <div class="flex gap-3 mt-6 pt-6 border-t border-border">
        <a href="{% url 'dashboard:media:library' %}" class="btn btn-secondary flex-1">
          {% translate 'Back to Library' %}
        </a>
        <a href="{% url 'dashboard:media:file_delete' media_file.pk %}" 
           class="btn bg-red-500 hover:bg-red-600 text-white flex-1"
           onclick="return confirm('{% translate "Are you sure you want to delete this file?" %}')">
          {% translate 'Delete' %}
        </a>
      </div>
    </div>
  </div>
</div>
{% endblock %}
